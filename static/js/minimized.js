function getCookie(c){var d=null;if(document.cookie&&document.cookie!=''){var e=document.cookie.split(';');for(var b=0;b<e.length;b++){var f=jQuery.trim(e[b]);if(f.substring(0,c.length+1)==(c+'=')){d=decodeURIComponent(f.substring(c.length+1));break}}}return d}var csrftoken=getCookie('csrftoken');function csrfSafeMethod(b){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(b))};$.ajaxSetup({beforeSend:function(c,b){if(!csrfSafeMethod(b.type)&&!this.crossDomain){c.setRequestHeader("X-CSRFToken",csrftoken)}}});var host=document.location.host;$(document).ready(function(){showTweets(host,true)});$('table').on({click:function(){var b=$(this).parent().parent().find('.id').text();$.ajax({url:'http://'+host+'/tweet/'+b+'/',type:'DELETE',success:function(b){showTweets(host)},error:function(d,b,c){console.log(d,b,c)}})}},'.delete-tweet');$('table').on({click:function(){var b=$(this).parent().find('.id').text();$.ajax({url:'http://'+host+'/like/'+b+'/',type:'POST',success:function(){var c=parseInt($('#'+b).find('.likes').text())+1;$('#'+b).find('.likes').text(c)},error:function(b,d,c){console.log(b,d,c)}})}},'.likes');$('table').on({click:function(){var b=$(this).parent().parent().find('.id').text();$.ajax({url:'http://'+host+'/retweet/'+b+'/',type:'POST',success:function(){var c=parseInt($('#'+b).find('.shares').text())+1;$('#'+b).find('.shares').text(c)},error:function(d,b,c){console.log(d,b,c)}})}},'.retweet-tweet');var addButtonInfoCell=function(g,b,h,d){if(h){var c=document.createElement("input");c.type="button";c.name=b;c.value=b.charAt(0).toUpperCase()+b.slice(1);var e=b+'-tweet';$('th.'+e).text('');if(b.charAt(0)=='d'){e+=' btn-danger'}else{e+=' btn-primary'}c.className="btn btn-xs "+e;g.appendChild(c)}else{var f='th#'+b+'Header';if(b.charAt(0)=='r'){if($(f).text()===''){$(f).text('Retweeted from')}if(d){getTweet(d,function(b){g.appendChild(document.createTextNode(b.author.first_name+' '+b.author.last_name))})}}else{if($(f).text()===''){$(f).text('Author')}if(d){g.appendChild(document.createTextNode(d.first_name+' '+d.last_name))}}}};function addRow(k,c,j,l){var m=document.getElementById(k);var b=m.insertRow();b.id=c.id;var d=b.insertCell(0);d.className='id';d.style.display='none';d.appendChild(document.createTextNode(c.id));var g=b.insertCell(1);g.className='tweet';g.appendChild(document.createTextNode(c.text));var e=b.insertCell(2);e.appendChild(document.createTextNode(c.likes));e.className='likes';var f=b.insertCell(3);f.className='shares';f.appendChild(document.createTextNode(c.shares));var i=b.insertCell(4);addButtonInfoCell(i,'retweet',l,c.origin);var h=b.insertCell(5);addButtonInfoCell(h,'delete',j,c.author)};var getTweet=function(b,c){$.ajax({url:'http://'+host+'/tweet/'+b+'/',type:'GET',headers:{'Content-Type':'application/json'},success:function(b){c(b)},error:function(c,b,d){console.log(c,b,d)}})};var showTweets=function(b){$.ajax({url:'http://'+b+'/wall/',type:'GET',headers:{'Content-Type':'application/json'},success:function(b){$('#tweetBody').empty();b.forEach(function(b,c){addRow('tweetBody',b,true,false)})},error:function(d,b,c){console.log(d,b,c)}})};$('#publishTweet').on({click:function(){var b=$("#newTweetText").val();var c={'text':b};$.ajax({url:'http://'+host+'/tweet/',type:'POST',headers:{'Content-Type':'application/json'},data:JSON.stringify(c),success:function(){$("#newTweetText").val('');showTweets(host,true)},error:function(d,c,b){console.log(d,c,b)}})}});$('#home').on({click:function(){$('#home').parent().find('li').each(function(){$(this).removeClass('active')});$('#home').addClass('active');location.href='http://'+host+'/home/'}});$('#popularTweets').on({click:function(){$('#popularTweets').parent().find('li').each(function(){$(this).removeClass('active')});$('#popularTweets').addClass('active');$.ajax({url:'http://'+host+'/popular/',type:'GET',success:function(b){$('#tweetBody').empty();b.forEach(function(b,c){addRow('tweetBody',b,false,true)})},error:function(c,d,b){console.log(c,d,b)}})}});$('#newestTweets').on({click:function(){$('#newestTweets').parent().find('li').each(function(){$(this).removeClass('active')});$('#newestTweets').addClass('active');$.ajax({url:'http://'+host+'/newest/',type:'GET',success:function(b){$('#tweetBody').empty();b.forEach(function(b,c){addRow('tweetBody',b,false,true)})},error:function(b,c,d){console.log(b,c,d)}})}});